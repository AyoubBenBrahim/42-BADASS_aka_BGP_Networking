hostname aybouras-1
no ipv6 forwarding
!
interface lo
    ip address 1.1.1.1/32
!
interface eth0
    ip address 10.1.1.1/30
!
interface eth1
    ip address 10.1.1.5/30
!
interface eth2
    ip address 10.1.1.9/30
!
!
router bgp 1  (6500)
    neighbor ibgp peer-group  (neighbors/peers) / defines a peer-group called (neighbor peer-group ibgp)
    neighbor ibgp remote-as 1
    neighbor ibgp  update-source lo
    bgp listen range 1.1.1.0/29 peer-group ibgp
!
    address-family l2vpn evpn  (the type of information BGP can distribute) 
        neighbor ibgp route-reflector-client
        neighbor ibgp activate
    exit-address-family
!
router ospf
    network 0.0.0.0/0 area 0



======

neighbor {<IP-ADDRESS>|<PEER-GROUP-NAME>} route-reflector-client

neighbor 1.1.1.1 route-reflector-client

configures the router as a BGP route reflector and the specified peer as its client. 
Without this, no EVPN routes will be distributed to the leaves.

====

Neighbor <peer group name> peer-group
	Cr√©ez un groupe de pairs BGP.

    =====


    BGP Dynamic Neighbors are a way to bring up  BGP neighbors without specifically defining the neighbors remote IP address.
    Using the BGP Listen Range command you specify a range of IP addresses typically on your Hub site that you trust to become BGP neigbors with you.

    R1#sh run int f0/0

    interface FastEthernet0/0
     ip address 172.16.1.1 255.255.255.0
    R1#sh run | sec router bgp
    router bgp 65000
     bgp listen range 172.16.1.0/24 peer-group DYNAMIC
     neighbor DYNAMIC peer-group
     neighbor DYNAMIC remote-as 65000
    R1#


https://ipwithease.com/dynamic-bgp-peering/


BGP Dynamic Neighbors / BGP Listen Range

The BGP dynamic neighbors feature is supported in some implementations where one end, the listening end, is passive.
It is just told what IP subnet to accept connections from, and is associated with a peer group that controls the characteristics of the peering session.

router bgp 65011
      ...
      neighbor SERVERS peer-group
      neighbor SERVERS remote-as 64512
      bgp listen range 172.16.1.0/24 peer-group SERVERS
      ...
The listen command notifies BGP to accept any BGP connection that is received on the 172.16.1.0/24 subnet and treat the configuration for this peering session to be taken from the peer-group template, SERVERS.

Cloud Native Data Center Networking p 330

========

RR to avoid full-mesh topology(all leafs connected)
RR take the VTEP information and redistribute/Reflect it to the other VTEPs
https://youtu.be/9Hq8W9PZYus?t=2753

To simplify repetition when configuring multiple neighbors, most routing suites support a form of templating called peer group.
The user creates a peer group with a name and then proceeds to configure the desired attributes
for neighbor connection (such as remote-as, connection timers, and the use of BFD). In the next step,
the operator assigns each real neighbor to the created peer group, thus avoiding the need to type the same boring stuff over and over again.

Cloud Native Data Center Networking p 307




1/ defines a peer-group called ISL.
2/ assign attributes that all members of the peer-group share.
3/ adds this neighbor to the peer-group already defined.



1 / Enable EVPN between BGP Neighbors
    To enable EVPN between BGP neighbors, add the address family evpn to the existing neighbor address-family activation command.

Advertise All VNIs

